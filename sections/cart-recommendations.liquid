{{ 'component-cart-recommendations.css' | asset_url | stylesheet_tag }}

<div class="cart-recommendations" data-section-type="cart-recommendations">
  <div class="container">
    {% if section.settings.heading != blank %}
      <h2 class="cart-recommendations__heading">{{ section.settings.heading | escape }}</h2>
    {% endif %}

    {% if section.settings.subheading != blank %}
      <p class="cart-recommendations__subheading">{{ section.settings.subheading | escape }}</p>
    {% endif %}

    <div class="cart-recommendations__loading" id="recommendations-loading">
      <div class="cart-recommendations__loading-spinner"></div>
      <p>{{ 'cart_recommendations.loading' | t }}</p>
    </div>

    <div class="cart-recommendations__error" id="recommendations-error" style="display: none;">
      <p>{{ 'cart_recommendations.error_message' | t }}</p>
      <button type="button" class="cart-recommendations__retry-button" id="recommendations-retry">
        {{ 'cart_recommendations.retry_button' | t }}
      </button>
    </div>

    <div class="cart-recommendations__list" id="recommendations-list" style="display: none;">
      <!-- 推荐商品将通过JavaScript动态插入 -->
    </div>
  </div>
</div>

<script>
  window.cartRecommendationsSettings = {
    apiUrl: {{ section.settings.api_endpoint | json }},
    maxProducts: {{ section.settings.max_products | json }},
    sectionId: {{ section.id | json }}
  };
</script>

{{ 'cart-recommendations.js' | asset_url | script_tag }}

{% schema %}
{
  "name": "Cart Recommendations",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Recommended for you"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "You might also like these discounted products"
    },
    {
      "type": "url",
      "id": "api_endpoint",
      "label": "API Endpoint URL",
      "info": "URL of the API endpoint that returns recommended products JSON. Leave empty to use local demo data.",
      "default": ""
    },
    {
      "type": "range",
      "id": "max_products",
      "label": "Maximum Products",
      "min": 1,
      "max": 20,
      "step": 1,
      "default": 6
    }
  ],
  "presets": [
    {
      "name": "Cart Recommendations"
    }
  ]
}
{% endschema %}