{% comment %}
  Renders a progress bar showing how close the cart is to free shipping.
  Usage:
    {% render 'shipping-progress-bar' %}
  Optional param: threshold in cents (default = 2500 => $25)
{% endcomment %}

{% assign threshold = threshold | default: 2500 %}
{% assign total = cart.total_price | default: 0 %}
{% assign percent = total | times: 100 | divided_by: threshold | at_most: 100 %}

<div class="shipping-progress">
  {% if total < threshold %}
    {% assign remaining = threshold | minus: total %}
    <p class="shipping-progress-text" style="font-size: 16px;">
      再加 {{ remaining | money_without_trailing_zeros }} 即可免邮
    </p>
  {% else %}
    <p class="shipping-progress-text success" style="font-size: 16px;">
      🎉 Free shipping！
    </p>
  {% endif %}
  <div class="shipping-progress-bar" style="height: 8px; background: #f2f2f2;">
    <div class="shipping-progress-fill" style="width: {{ percent }}%; height: 100%; background: #000;"></div>
  </div>
</div>

<style>
.shipping-progress{margin:0 0 1rem;}
.shipping-progress-text{text-align:center;margin-bottom:.5rem}
.shipping-progress-bar{border-radius:4px;overflow:hidden}
.shipping-progress-fill{border-radius:4px}
</style>
