{% comment %}
  Renders free shipping banner
  
  Displays dynamic free shipping progress based on cart subtotal with $25 threshold
  
  Usage:
  {% render 'free-shipping-banner' %}
{% endcomment %}

{%- assign threshold_cents = 25 | times: 100 -%}
{%- assign cart_subtotal_cents = cart.total_price -%}
{%- assign remaining_cents = threshold_cents | minus: cart_subtotal_cents -%}
{%- assign remaining_amount = remaining_cents | money -%}
{%- assign progress_percent = cart_subtotal_cents | times: 100 | divided_by: threshold_cents -%}
{%- if progress_percent > 100 -%}
  {%- assign progress_percent = 100 -%}
{%- endif -%}

<div class="free-shipping-banner" data-threshold="{{ threshold_cents }}" role="banner" aria-live="polite">
  <div class="free-shipping-banner__content">
    {%- if cart.item_count == 0 -%}
      <div class="free-shipping-banner__message">
        <span class="free-shipping-banner__icon">🚚</span>
        <span class="free-shipping-banner__text">Free Shipping on Orders $25+</span>
      </div>
    {%- elsif cart_subtotal_cents < threshold_cents -%}
      <div class="free-shipping-banner__message">
        <span class="free-shipping-banner__icon">💝</span>
        <span class="free-shipping-banner__text">
          Woohoo! You're only {{ remaining_amount }} away from free shipping!
        </span>
      </div>
    {%- else -%}
      <div class="free-shipping-banner__message free-shipping-banner__message--unlocked">
        <span class="free-shipping-banner__icon">🎉</span>
        <span class="free-shipping-banner__text">
          Congrats! You've unlocked FREE shipping!
        </span>
      </div>
    {%- endif -%}
  </div>
</div>
